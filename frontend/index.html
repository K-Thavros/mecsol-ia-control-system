<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MECSOL - Dashboard de Control de Agentes IA</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f2f5; color: #333; margin: 0; padding: 20px; }
        .container { max-width: 900px; margin: auto; background: #fff; padding: 25px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #0056b3; }
        .agent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .agent-card { border: 1px solid #ddd; border-radius: 8px; padding: 20px; text-align: center; transition: all 0.3s ease; }
        .agent-card h2 { margin-top: 0; color: #0056b3; }
        .status { font-size: 1.2em; font-weight: bold; padding: 5px 10px; border-radius: 5px; color: #fff; }
        .status.online { background-color: #28a745; }
        .status.offline { background-color: #dc3545; }
        .status.loading { background-color: #ffc107; color: #333; }
        button { background-color: #007bff; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; font-size: 1em; margin-top: 15px; transition: background-color 0.2s; }
        button:hover { background-color: #0056b3; }
        pre { background-color: #e9ecef; padding: 10px; border-radius: 5px; text-align: left; white-space: pre-wrap; word-wrap: break-word; margin-top: 15px; font-size: 0.9em; }
    </style>
</head>
<body>

    <div class="container">
        <h1>Dashboard de Control de Agentes IA</h1>
        <div class="agent-grid">
            <!-- Agente Financiero -->
            <div class="agent-card" id="finance-card">
                <h2>Agente Financiero</h2>
                <div id="finance-status" class="status loading">Contactando...</div>
                <button onclick="fetchData('finance')">Consultar Datos</button>
                <pre id="finance-data">Respuesta del agente aparecerá aquí.</pre>
            </div>

            <!-- Agente de Operaciones -->
            <div class="agent-card" id="operations-card">
                <h2>Agente de Operaciones</h2>
                <div id="operations-status" class="status loading">Contactando...</div>
                <button onclick="fetchData('operations')">Consultar Datos</button>
                <pre id="operations-data">Respuesta del agente aparecerá aquí.</pre>
            </div>

            <!-- Agente Comercial -->
            <div class="agent-card" id="commercial-card">
                <h2>Agente Comercial</h2>
                <div id="commercial-status" class="status loading">Contactando...</div>
                <button onclick="fetchData('commercial')">Consultar Datos</button>
                <pre id="commercial-data">Respuesta del agente aparecerá aquí.</pre>
            </div>
        </div>
    </div>

<script>
    const agents = ['finance', 'operations', 'commercial'];

    async function checkStatus(agentName) {
        const statusEl = document.getElementById(`${agentName}-status`);
        try {
            const response = await fetch(`/api/${agentName}/status`);
            if (!response.ok) throw new Error('Network response was not ok');

            const data = await response.json();
            statusEl.textContent = data.status || 'En línea';
            statusEl.className = 'status online';
        } catch (error) {
            console.error(`Error checking status for ${agentName}:`, error);
            statusEl.textContent = 'Offline';
            statusEl.className = 'status offline';
        }
    }

    async function fetchData(agentName) {
        const dataEl = document.getElementById(`${agentName}-data`);
        dataEl.textContent = 'Obteniendo datos...';
        try {
            const response = await fetch(`/api/${agentName}/data`);
            if (!response.ok) throw new Error(`Error ${response.status}: ${response.statusText}`);

            const data = await response.json();
            dataEl.textContent = JSON.stringify(data, null, 2);
        } catch (error) {
            console.error(`Error fetching data for ${agentName}:`, error);
            dataEl.textContent = `Error al contactar al agente.\n${error.message}`;
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        agents.forEach(agent => {
            checkStatus(agent);
            // Pre-fill with instructions
            document.getElementById(`${agent}-data`).textContent = 'Presione "Consultar Datos" para obtener información.';
        });
    });
</script>

</body>
</html>
